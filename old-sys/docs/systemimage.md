### YourselfLMにおける情報収集と人格情報保存の仕組み（私の理解）

YourselfLMの核心は、**ユーザーとの自然な対話や特定の問いかけを通じて得られる情報を、意味のある単位（エピソードやユーザーの自己認識など）として捉え、それを構造化された「人格情報フォーマット」に継続的に記録・更新していく**プロセスにあると理解しています。

その具体的なステップは以下のようになると考えています。

1.  **対話による情報収集フェーズ:**
    *   **入力ソース:**
        *   **自由対話:** ユーザーが日々の出来事、感じたこと、考えたことなどを自由にYourselfLMに語りかける。
        *   **誘導的な対話（AIからの問いかけ）:** YourselfLMが、ユーザーの自己理解を深めるために、ナラティブセラピー的なアプローチに基づいた質問（例：「最近心が動いたことは？」「その時どう感じましたか？」）や、特定のテーマ（例：過去の成功体験、価値観など、20個のタグに関連する内容）に関する問いかけを行う。
        *   **ユーザーによる直接入力:** ユーザーが特定のタグ（例：「趣味・興味」「信念・価値観」）に対して、直接的に情報を入力するインターフェースも利用可能。
    *   **AIの役割（情報抽出）:**
        *   LLMが自然言語処理（NLP）技術を駆使し、ユーザーの発言から重要な要素をリアルタイムまたはバッチ処理で解析・抽出します。
            *   **感情の特定:** 発言に含まれる感情（喜び、悲しみ、怒りなど）とその強度。
            *   **キーワード・トピックの抽出:** 会話の中心となっている話題や重要な言葉。
            *   **エンティティ認識:** 関連する人物、場所、時間、組織など。
            *   **出来事（エピソード）の切り出し:** 具体的な体験や出来事に関する記述を特定。
            *   **関連性の推定:** 発言間の関連性、過去のエピソードとの繋がりなどを推測。

2.  **エピソードと情報の構造化・一次記録フェーズ:**
    *   **構造化:** AIによって抽出された情報は、定義された「個々の発言・エピソードレベル」のフォーマットに従って構造化されます。これには以下の要素が含まれることを想定しています。
        *   `id`（一意な識別子）
        *   `entry_date`（発言・記録日時）
        *   `source_type`（例: free_dialogue, ai_prompted_response, direct_user_input）
        *   `text_content`（ユーザーの元発言）
        *   `emotion_analysis`（感情の極性、強度、具体的な感情ラベルなど）
        *   `keywords`（抽出されたキーワードリスト）
        *   `topics`（関連するトピックのリスト）
        *   `related_entities`（関連する人物、場所など）
        *   `user_importance_initial`（ユーザーがその場で評価した重要度、あれば）
    *   **ユーザーへの確認とフィードバック（オプション）:**
        *   重要な情報が抽出されたとAIが判断した場合、「今の〇〇というお話は、特に印象的でしたか？記録しておきますか？」といった形でユーザーに確認を求める。
        *   ユーザーがAIの解釈（例：感情分析の結果）に対して、その場で修正や補足を行えるインターフェース。
    *   **一時的/半恒久的な記録:** これらの構造化された情報は、まずデータベース内の個別の記録として保存されます。

3.  **人格情報フォーマット (`user_profile`) への統合・永続化フェーズ:**
    *   **マッピング:** 一次記録されたエピソードや情報は、改良案で議論した `user_profile` の適切なセクション（例: `significant_childhood_experiences`, `hobbies_interests`, `emotional_reaction_patterns`など、20個のタグに対応する項目）にマッピングされ、永続的に保存されます。
        *   このマッピングは、AIが内容を解釈して自動的に行う場合と、ユーザーが特定のタグに情報を紐付けることで行われる場合があります。
    *   **メタ情報の付与:** 各エントリには、`user_importance`, `ai_confidence_score`, `status` (`active`, `archived`, `other_data`など) といったメタ情報が付与されます。
    *   **AIによる分析結果の記録:**
        *   蓄積されたエピソードやユーザー情報に基づいて、AIが定期的に、あるいはユーザーの指示によって分析を行います。
        *   その結果（例: Big Fiveスコアの推定、主要テーマの抽出と要約、認識された感情パターン、総括的な洞察など）は、`user_profile` 内の `ai_analysis_results` セクションに、分析日時や根拠データへのリンクと共に記録されます。
    *   **ユーザーフィードバックの反映:**
        *   ユーザーがAIの分析結果や解釈に対して行ったフィードバック（「この分析は違う」など）は `user_feedback_log` に記録され、AIの今後の分析精度向上や、該当情報の `status` 変更（例: `other_data_user_denied`へ）に繋がります。
    *   **「OtherData」の扱い:** ユーザーが「重要ではない」「これは違う」と判断した情報や、AI自身が信頼度が低いと判断した情報は、`status` を変更し、低い重み付けで管理するか、陳腐化ポリシーに従って削除対象とします。

4.  **人格情報の継続的な更新と活用:**
    *   **動的なプロファイル:** `user_profile` は一度作ったら終わりではなく、新しい対話やエピソードが追加されるたびに、AIによる再分析やユーザーによる「棚卸し」を通じて、継続的に更新・洗練されていく「生きている」情報となります。
    *   **AIの応答と分析への活用:** 保存・更新された人格情報は、AIがよりユーザーにパーソナライズされた、深い理解に基づいた応答や分析を行うための基礎データとして常に参照されます。
    *   **「棚卸し」機能との連携:** ユーザーが「棚卸し」を行う際には、この `user_profile` に蓄積された情報（ユーザー入力情報、AI分析結果、ステータスなど）が提示され、ユーザーはそれらをレビューし、評価を変更したり、新たな気づきを追記したり、不要な情報を整理したりします。

---

**要約すると、YourselfLMの仕組みは、**

*   ユーザーとの多様なインタラクション（自由対話、誘導的質問、直接入力）から情報を収集する。
*   AI (LLM) がその情報を解析・構造化し、一時的に記録する。
*   構造化された情報とAIによる分析結果を、包括的な「人格情報フォーマット (`user_profile`)」にマッピングし、メタ情報（重要度、信頼度、ステータスなど）と共に永続的に保存する。
*   この `user_profile` は、ユーザーの成長や変化、AIの学習、ユーザーフィードバックによって動的に更新され、より精度の高い自己理解支援の基盤となる。

